<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>æµ®ä¸–ç¹ªç§‘æŠ€ - ææ–™ç®¡ç†ç³»çµ±</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&family=Orbitron:wght@600;900&display=swap" rel="stylesheet" />
<style>
/* --- æµ®ä¸–ç¹ª 3D è¦–è¦ºèƒŒæ™¯ --- */
:root {
    --ukiyo-blue: #1a3a5f; /* è‘›é£¾åŒ—é½‹æ·±è— */
    --ukiyo-red: #d64545;  /* å¤ªé™½ç´… */
    --ukiyo-sand: #f2e6d9; /* å®£ç´™è‰² */
    --glass: rgba(255, 255, 255, 0.85);
}

body {
    font-family: 'Noto Sans TC', sans-serif;
    margin: 0; padding: 0 16px 80px;
    background: 
        linear-gradient(rgba(242, 230, 217, 0.8), rgba(242, 230, 217, 0.8)),
        url('https://www.transparenttextures.com/patterns/pinstripe.png'),
        radial-gradient(circle at 80% 20%, var(--ukiyo-red) 0%, transparent 25%),
        linear-gradient(135deg, #1a3a5f 0%, #4682b4 50%, #f2e6d9 100%);
    background-attachment: fixed;
    background-size: cover;
    color: #1a202c;
    overflow-x: hidden;
}

/* --- 3D æ¨™é¡Œèˆ‡å°èˆª --- */
header {
    position: sticky; top: 15px; z-index: 100;
    max-width: 900px; margin: 20px auto;
    background: rgba(26, 58, 95, 0.9);
    backdrop-filter: blur(15px);
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 20px;
    padding: 20px;
    display: flex; align-items: center;
    box-shadow: 0 20px 40px rgba(0,0,0,0.3);
    color: white;
    transform: perspective(1000px) rotateX(2deg);
}
header h1 { font-family: 'Orbitron', sans-serif; margin: 0; font-size: 1.6rem; letter-spacing: 2px; }
header span { font-family: 'Noto Sans TC'; font-size: 1rem; opacity: 0.8; margin-left: 10px; }

/* --- 3D ç£¨ç ‚ç»ç’ƒå¡ç‰‡ --- */
.container-3d {
    background: var(--glass);
    backdrop-filter: blur(10px);
    max-width: 850px; margin: 30px auto;
    border-radius: 30px; padding: 40px;
    border: 1px solid rgba(255,255,255,0.5);
    box-shadow: 20px 20px 60px rgba(0,0,0,0.1), inset 0 0 20px rgba(255,255,255,0.5);
    transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}
.container-3d:hover { transform: translateY(-5px) scale(1.01); }

h3.section-title {
    color: var(--ukiyo-blue);
    border-bottom: 3px solid var(--ukiyo-red);
    display: inline-block;
    padding-bottom: 5px;
    margin-bottom: 25px;
}

/* --- è¡¨å–®æ§åˆ¶é … --- */
.form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px; }
label { font-weight: 900; color: var(--ukiyo-blue); margin-bottom: 8px; display: block; }

input, select {
    width: 100%; padding: 14px; border-radius: 12px;
    border: 2px solid #cbd5e1; background: white;
    font-size: 1.1rem; transition: 0.3s;
}
input:focus { outline: none; border-color: var(--ukiyo-red); box-shadow: 0 0 10px rgba(214, 69, 69, 0.2); }

/* --- ææ–™å¡ç‰‡ --- */
#materialsContainer {
    display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 15px; margin-top: 15px;
}
.material-card {
    background: white; padding: 15px; border-radius: 12px;
    border: 2px solid #e2e8f0; cursor: pointer; text-align: center;
    transition: all 0.2s ease;
}
.material-card:hover { border-color: var(--ukiyo-blue); transform: scale(1.05); }
.card-selected { background: var(--ukiyo-blue); color: white; border-color: var(--ukiyo-blue); }

/* --- æ­·å²ç´€éŒ„æœå°‹å€ --- */
.summary-area {
    background: rgba(15, 23, 42, 0.95);
    border-radius: 30px; padding: 35px;
    max-width: 850px; margin: 40px auto;
    color: white; box-shadow: 0 30px 60px rgba(0,0,0,0.4);
}
.search-container {
    background: rgba(255,255,255,0.1); padding: 20px;
    border-radius: 20px; margin-bottom: 20px;
}
.record-li {
    background: rgba(255,255,255,0.05); border-left: 6px solid var(--ukiyo-red);
    padding: 20px; border-radius: 15px; margin-bottom: 15px;
    display: flex; justify-content: space-between; align-items: center;
}
.record-li.take { border-left-color: #60a5fa; }

/* æŒ‰éˆ•é¢¨æ ¼ */
.btn-save {
    width: 100%; padding: 20px; border: none; border-radius: 15px;
    background: var(--ukiyo-blue); color: white; font-size: 1.4rem;
    font-weight: 900; cursor: pointer; margin-top: 20px;
    box-shadow: 0 10px 20px rgba(26, 58, 95, 0.4);
}
.btn-save:hover { filter: brightness(1.2); transform: translateY(-2px); }

@media (max-width: 600px) { .form-row { grid-template-columns: 1fr; } }
</style>
</head>
<body>

<header>
    <h1>UKIYO TECH <span>ææ–™ç®¡ç†ç³»çµ±</span></h1>
</header>

<div class="container-3d">
    <form id="materialForm">
        <h3 class="section-title">å£¹ã€æ—¥æœŸèˆ‡å–®æ“š</h3>
        <div class="form-row">
            <div>
                <label>ç•°å‹•æ—¥æœŸ (é ˜ç”¨/é€€æ–™æ—¥)</label>
                <input type="date" id="mainDate" required />
            </div>
            <div>
                <label>åŸå€Ÿç”¨æ—¥æœŸ (åƒ…é€€æ–™æ™‚å¡«å¯«)</label>
                <input type="date" id="borrowDate" />
            </div>
        </div>

        <div class="form-row">
            <div>
                <label>ä½œæ¥­é¡å‹</label>
                <select id="transType" onchange="adjustUI()">
                    <option value="é ˜æ–™">é ˜æ–™ (Take)</option>
                    <option value="å€Ÿç”¨">å€Ÿç”¨ (Borrow)</option>
                    <option value="é€€æ–™">é€€æ–™ (Return)</option>
                </select>
            </div>
            <div>
                <label>å–®è™Ÿç·¨ç¢¼</label>
                <input type="text" id="orderNo" placeholder="è«‹è¼¸å…¥å–®è™Ÿ" />
            </div>
        </div>

        <h3 class="section-title">è²³ã€äººå“¡è³‡è¨Š</h3>
        <div class="form-row">
            <div>
                <label id="lblPerson">é ˜æ–™/é€€æ–™äººå§“å</label>
                <input type="text" id="personName" placeholder="è«‹è¼¸å…¥å§“å" required />
            </div>
            <div>
                <label id="lblStaff">ç™¼æ–™/æ”¶æ–™ç¶“è¾¦äºº</label>
                <input type="text" id="staffName" placeholder="è«‹è¼¸å…¥å§“å" required />
            </div>
        </div>

        <h3 class="section-title">åƒã€ææ–™é¸å–</h3>
        <label>ææ–™é¡åˆ¥</label>
        <select id="category" onchange="renderMaterials()">
            <option value="">-- è«‹é¸æ“‡é¡åˆ¥ --</option>
            <option value="A">A é¡ (ç¤™å­)</option>
            <option value="B">B é¡ (é‡‘å…·)</option>
            <option value="C">C é¡ (ç·šæ)</option>
            <option value="F">F é¡ (è®Šå£“å™¨)</option>
            <option value="H">H é¡ (é–‹é—œ)</option>
        </select>
        <div id="materialsContainer"></div>

        <div id="qtySection" style="display:none; margin-top:20px;">
            <div class="form-row">
                <div>
                    <label>æ•¸é‡</label>
                    <input type="number" id="qty" min="1" value="1" />
                </div>
                <div>
                    <label>å–®ä½/è©•åƒ¹</label>
                    <input type="text" id="unit" placeholder="ä¾‹: pc / 0" />
                </div>
            </div>
        </div>

        <button type="submit" class="btn-save">ğŸ’¾ ç´€éŒ„è³‡æ–™ (SAVE)</button>
    </form>
</div>

<div class="summary-area">
    <h2 style="font-family:'Orbitron'; color:var(--ukiyo-red)">HISTORY SEARCH</h2>
    
    <div class="search-container">
        <label style="color:white">ğŸ” å§“åæœå°‹ (é ˜ç”¨ã€å€Ÿç”¨ã€é€€æ–™ã€æ”¶ç™¼äººçš†å¯æœ)</label>
        <input type="text" id="searchName" placeholder="è¼¸å…¥å§“å..." onkeyup="filterHistory()" style="background:rgba(255,255,255,0.9)" />
    </div>

    <div id="logList">
        </div>
</div>

<script>
// ææ–™è³‡æ–™ (ç°¡åŒ–ä¾›ç¤ºç¯„ï¼Œå»ºè­°å»¶ç”¨æ‚¨åŸæœ‰çš„å®Œæ•´æ¸…å–®)
const materialDict = {
    "A": ["èšåˆæŸ±å‹ç¤™å­ 11.4kV", "æ‡¸å‚ç¤™å­ Cå‹ ç°è‰²", "é˜²ç›¬è£è…³ç¤™å­"],
    "B": ["äº’é€£å™¨ 477MCM", "é…é›»åå…‰è²¼ç´™", "æ‹‰ç·šå¤¾æ¿", "æ´»ç·šç·šå¤¾"],
    "C": ["25KVäº¤é€£PEç·š", "600V PVCé¢¨é›¨ç·š", "ç¡¬éŠ…çµç·š"],
    "F": ["äº­ç½®å¼é–‹é—œ SF6", "æ¡¿ä¸Šè®Šå£“å™¨ 50kVA", "é åŠ›é›»æ¡¿ 12m"],
    "H": ["é›»åŠ›ä¿éšªçµ²åº§", "é¿é›·å™¨ 9KV", "ç†”çµ²éˆé–‹é—œ"]
};

let records = JSON.parse(localStorage.getItem("ukiyo_material_db") || "[]");
let currentMaterial = "";

// åˆå§‹åŒ–ï¼šè¨­å®šä»Šæ—¥æ—¥æœŸ
document.getElementById('mainDate').valueAsDate = new Date();

function adjustUI() {
    const type = document.getElementById("transType").value;
    document.getElementById("lblPerson").innerText = type === "é€€æ–™" ? "é€€æ–™äººå§“å" : "é ˜æ–™/å€Ÿç”¨äººå§“å";
    document.getElementById("lblStaff").innerText = type === "é€€æ–™" ? "æ”¶æ–™ç¶“è¾¦äºº" : "ç™¼æ–™ç¶“è¾¦äºº";
}

function renderMaterials() {
    const cat = document.getElementById("category").value;
    const container = document.getElementById("materialsContainer");
    container.innerHTML = "";
    if(!cat) return;

    materialDict[cat].forEach(m => {
        const div = document.createElement("div");
        div.className = "material-card";
        div.innerText = m;
        div.onclick = () => {
            document.querySelectorAll('.material-card').forEach(c => c.classList.remove('card-selected'));
            div.classList.add('card-selected');
            currentMaterial = m;
            document.getElementById("qtySection").style.display = "block";
        };
        container.appendChild(div);
    });
}

document.getElementById("materialForm").onsubmit = function(e) {
    e.preventDefault();
    if(!currentMaterial) { alert("è«‹é¸å–ææ–™ï¼"); return; }

    const data = {
        id: Date.now(),
        date: document.getElementById("mainDate").value,
        borrowDate: document.getElementById("borrowDate").value,
        type: document.getElementById("transType").value,
        person: document.getElementById("personName").value.trim(),
        staff: document.getElementById("staffName").value.trim(),
        order: document.getElementById("orderNo").value.trim(),
        item: currentMaterial,
        qty: document.getElementById("qty").value,
        unit: document.getElementById("unit").value
    };

    records.unshift(data);
    localStorage.setItem("ukiyo_material_db", JSON.stringify(records));
    alert("ç´€éŒ„æˆåŠŸï¼");
    this.reset();
    document.getElementById('mainDate').valueAsDate = new Date();
    currentMaterial = "";
    document.getElementById("qtySection").style.display = "none";
    renderLogs();
};

function renderLogs(filterName = "") {
    const list = document.getElementById("logList");
    list.innerHTML = "";

    const filtered = records.filter(r => {
        const nameMatch = r.person.includes(filterName) || r.staff.includes(filterName);
        return nameMatch;
    });

    if(filtered.length === 0) {
        list.innerHTML = "<p style='text-align:center; opacity:0.5'>æŸ¥ç„¡ç´€éŒ„</p>";
        return;
    }

    filtered.forEach(r => {
        const li = document.createElement("div");
        li.className = `record-li ${r.type !== 'é€€æ–™' ? 'take' : ''}`;
        
        const borrowInfo = r.borrowDate ? `<br><small>åŸå€Ÿç”¨æ—¥: ${r.borrowDate}</small>` : "";
        
        li.innerHTML = `
            <div style="flex-grow:1">
                <strong style="color:var(--ukiyo-red)">${r.date} [${r.type}]</strong><br>
                <span style="font-size:1.2rem; font-weight:700">${r.item} x ${r.qty} ${r.unit}</span><br>
                <small>å–®è™Ÿ: ${r.order || "ç„¡"} | äººå“¡: ${r.person} (ç¶“è¾¦: ${r.staff})</small>
                ${borrowInfo}
            </div>
            <button onclick="deleteRecord(${r.id})" style="background:none; border:none; color:#f87171; cursor:pointer; font-size:1.5rem">ğŸ—‘ï¸</button>
        `;
        list.appendChild(li);
    });
}

function filterHistory() {
    const val = document.getElementById("searchName").value.trim();
    renderLogs(val);
}

function deleteRecord(id) {
    if(!confirm("ç¢ºå®šè¦åˆªé™¤æ­¤ç´€éŒ„ï¼Ÿ")) return;
    records = records.filter(r => r.id !== id);
    localStorage.setItem("ukiyo_material_db", JSON.stringify(records));
    filterHistory();
}

// é¦–æ¬¡è¼‰å…¥
renderLogs();
</script>
</body>
</html>
